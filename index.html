<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <title>townmi-blog</title>
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <!-- Styles -->
    <!-- <link href="css/bootstrap.css" rel="stylesheet"> -->
    <!-- <link rel="stylesheet" href="css/reset.css"> -->
    <link rel="stylesheet" href="css/font-awesome.min.css">
    <!-- <link rel="stylesheet" media="screen and (min-width: 1000px)" href="css/style.css"> -->
    <!-- <link rel="stylesheet" media="screen and (max-width: 1280px)" href="css/small.css" /> -->
    <link rel="stylesheet" type="text/css" href="css/common.css">

</head>
<body>

  	<div id="container">
        <div id="canvas">
            <div id="nav">
                <div class="ui_nav_block">
                    <h2>文章分类</h2>
                    <ul class="ui_nav_category">
                        <li><a href="" class="ui_link">javascript</a></li>
                        <li><a href="" class="ui_link">nodejs</a></li>
                        <li><a href="" class="ui_link">redis</a></li>
                        <li><a href="" class="ui_link">javascript</a></li>
                        <li><a href="" class="ui_link">nodejs</a></li>
                        <li><a href="" class="ui_link">redis</a></li>
                        <li><a href="" class="ui_link">javascript</a></li>
                        <li><a href="" class="ui_link">nodejs</a></li>
                        <li><a href="" class="ui_link">redis</a></li><li><a href="" class="ui_link">javascript</a></li>
                        <li><a href="" class="ui_link">nodejs</a></li>
                        <li><a href="" class="ui_link">redis</a></li>
                        <li><a href="" class="ui_link">javascript</a></li>
                        <li><a href="" class="ui_link">nodejs</a></li>
                        <li><a href="" class="ui_link">redis</a></li>
                        <li><a href="" class="ui_link">javascript</a></li>
                        <li><a href="" class="ui_link">nodejs</a></li>
                        <li><a href="" class="ui_link">redis</a></li>
                    </ul>
                </div>
                <div class="ui_nav_block">
                    <h2>文章分类</h2>
                    <ul class="ui_nav_category">
                        <li><a href="" class="ui_link">javascript</a></li>
                        <li><a href="" class="ui_link">nodejs</a></li>
                        <li><a href="" class="ui_link">redis</a></li>
                        <li><a href="" class="ui_link">javascript</a></li>
                        <li><a href="" class="ui_link">nodejs</a></li>
                        <li><a href="" class="ui_link">redis</a></li>
                        <li><a href="" class="ui_link">javascript</a></li>
                        <li><a href="" class="ui_link">nodejs</a></li>
                        <li><a href="" class="ui_link">redis</a></li><li><a href="" class="ui_link">javascript</a></li>
                        <li><a href="" class="ui_link">nodejs</a></li>
                        <li><a href="" class="ui_link">redis</a></li>
                        <li><a href="" class="ui_link">javascript</a></li>
                        <li><a href="" class="ui_link">nodejs</a></li>
                        <li><a href="" class="ui_link">redis</a></li>
                        <li><a href="" class="ui_link">javascript</a></li>
                        <li><a href="" class="ui_link">nodejs</a></li>
                        <li><a href="" class="ui_link">redis</a></li>
                    </ul>
                </div>
                <div class="ui_nav_block">
                    <h2>文章分类</h2>
                    <ul class="ui_nav_category">
                        <li><a href="" class="ui_link">javascript</a></li>
                        <li><a href="" class="ui_link">nodejs</a></li>
                        <li><a href="" class="ui_link">redis</a></li>
                        <li><a href="" class="ui_link">javascript</a></li>
                        <li><a href="" class="ui_link">nodejs</a></li>
                        <li><a href="" class="ui_link">redis</a></li>
                        <li><a href="" class="ui_link">javascript</a></li>
                        <li><a href="" class="ui_link">nodejs</a></li>
                        <li><a href="" class="ui_link">redis</a></li><li><a href="" class="ui_link">javascript</a></li>
                        <li><a href="" class="ui_link">nodejs</a></li>
                        <li><a href="" class="ui_link">redis</a></li>
                        <li><a href="" class="ui_link">javascript</a></li>
                        <li><a href="" class="ui_link">nodejs</a></li>
                        <li><a href="" class="ui_link">redis</a></li>
                        <li><a href="" class="ui_link">javascript</a></li>
                        <li><a href="" class="ui_link">nodejs</a></li>
                        <li><a href="" class="ui_link">redis</a></li>
                    </ul>
                </div>
            	
                <h1 class="ui_share">
                    <img src="http://fd.topit.me/d/d6/73/11049699480a673d6dl.jpg" alt="" width="200px">
                    <a href="" class="ui_share_link"><i class="fa fa-github-square"></i></a>&nbsp;&nbsp;
                    <a href="" class="ui_share_link"><i class="fa fa-facebook-square"></i></a>&nbsp;&nbsp;
                    <a href="" class="ui_share_link"><i class="fa fa-twitter-square"></i></a>&nbsp;&nbsp;
                    <a href="" class="ui_share_link"><i class="fa fa-weibo"></i></a>
                    <p>powered by Townmi</p>
                </h1>
            </div>
            <div id="marsk"></div>
            <nav>
                <div class="toggle_nav" id="js_toggle_nav">
                    <div id="bars"></div>
                </div>
                <h1 class="ui_title">首页</h1>
            </nav>
            <div class="content">
                <!-- <section class="ui_content">
                    <div class="ui_ad">
                        <img src="http://xinghuo.yixin.com/upload/adPhoto/ad1436252769966.jpg" alt="">
                    </div>
                </section> -->
  
                <section class="ui_content">
                    <div class="ui_article_list">

                        <div class="ui_article">
                            <div class="ui_article_title">
                                <h3><a href="">How the 2015 #VMAs unfolded on Twitter</a></h3>
                            </div>

                            <div class="ui_article_tags">
                                <i class="fa fa-tags"></i><a href="">javascript</a>,<a href=""> javascript</a>
                                <i class="fa fa-calendar"></i><span>2015-09-10 10:20:20</span>
                                <a href="javascript:;" class="js_weixin"><i class="fa fa-weixin"></i></a>
                                <a href="javascript:;" class="js_weixin"><i class="fa fa-weibo"></i></a>
                            </div>

                            <div class="ui_article_body">
                                <div class="preview"> </div>
                            </div>
                            <div class="ui_article_foot">
                                <a href="">阅读全文</a>
                            </div>
                        </div>

                        <div class="ui_article">
                            <div class="ui_article_title">
                                <h3><a href="">How the 2015 #VMAs unfolded on Twitter</a></h3>
                            </div>

                            <div class="ui_article_tags">
                                <i class="fa fa-tags"></i><a href="">javascript</a>
                                <i class="fa fa-calendar"></i><span>2015-09-10 10:20:20</span>
                            </div>

                            <div class="ui_article_body">
                                <div class="preview"> </div>
                            </div>
                            <div class="ui_article_foot">
                                <a href="">阅读全文</a>
                            </div>
                        </div>

                        <div class="ui_article">
                            <div class="ui_article_title">
                                <h3><a href="">How the 2015 #VMAs unfolded on Twitter</a></h3>
                            </div>

                            <div class="ui_article_tags">
                                <i class="fa fa-tags"></i><a href="">javascript</a>
                                <i class="fa fa-calendar"></i><span>2015-09-10 10:20:20</span>
                            </div>

                            <div class="ui_article_body">
                                <div class="preview"> </div>
                            </div>
                            <div class="ui_article_foot">
                                <a href="">阅读全文</a>
                            </div>
                        </div>

                        
                    </div>
                </section>

                <div id="page" class="ui_content page_group"></div>
            </div>

            
        </div>
        
    </div>

    <!-- Scripts -->
    <script src="js/jquery-2.1.4.min.js"></script>
    <script src="js/markdown.js"></script>
    <script src="js/highlight.js"></script>
    <script src="js/custom.js"></script>
    <script type="text/javascript">

        var str = "# 测试MARKDOWN";

        str += "\n"+"测试爬到";
        str += "\n"+"```";
        str += "\n var a = 'assa';\n var test = function(){";
        str += "\n     return function(){";
        str += "\n         var b = true, c = 12, d = {ak: 'name is akse', age: 120, sex: 'boy', dadad: 'ad'}";
        str += "\n     }";
        str += "\n } ```";
        // console.log(hljs.highlightAuto(marked(str)))
        $(".preview").html( marked(str) ).find("pre code").each(function (i, block){
                hljs.highlightBlock(block);
            });

    </script>
    <script type="text/javascript">
        $(function(){
            $.fn.page = function () {

                var Page = function (dom, total) {
                    this.dom = dom
                    this.total = total;
                    this.currentPage = 0;
                    this.onePageLength = 5;
                    this.btns = 15;
                    this.size = Math.floor(this.total/this.onePageLength);
                };

                Page.prototype.http = function() {
                    this.data = {
                        "category": null,
                        "start": this.currentPage*this.onePageLength,
                        "end": this.currentPage*this.onePageLength+this.onePageLength
                    }
                    console.log(this.data);
                };

                Page.prototype.refreshView = function (currentPage) {

                    this.currentPage = currentPage*1;

                    var btns = $(this.dom).find('.js_page');

                    $(this.dom).find(".js_page").removeClass("active");

                    if(this.currentPage === 0){
                        $(this.dom).find(".js_page_prev").addClass("disabled");
                    } else {
                        $(this.dom).find(".js_page_prev").removeClass("disabled");
                    }

                    if(this.currentPage === this.size){
                        $(this.dom).find(".js_page_next").addClass("disabled");
                    } else {
                        $(this.dom).find(".js_page_next").removeClass("disabled");
                    }

                    if(this.size<this.btns){
                        btns.eq(this.currentPage).addClass("active");
                        return this.http();
                    }

                    if(this.currentPage<Math.ceil(this.btns/2)){
                        for (var i = 0; i < this.btns; i++) {
                            btns.eq(i).html(i+1);
                        };
                        btns.eq(this.currentPage).addClass("active");
                        return this.http();
                    }

                    if(this.currentPage>(this.size-Math.floor(this.btns/2))){
                        for (var i = 0; i < this.btns; i++) {
                            btns.eq(i).html(this.size+i-this.btns+2);
                        };
                        btns.eq(this.btns-(this.size-this.currentPage+1)).addClass("active");
                        return this.http();
                    }

                    for (var i = 0; i < this.btns; i++) {
                        btns.eq(i).html(this.currentPage+i-Math.floor(this.btns/2)+1);
                    };
                    btns.eq(Math.ceil(this.btns/2)-1).addClass("active");
                    this.http();
                };

                Page.prototype.event = function () {

                    var self = this;

                    $(this.dom).on("click", ".js_page", function () {
                        if($(this).hasClass("active")) return;
                        self.refreshView($(this).html()-1);
                    });

                    $(this.dom).on("click", ".js_page_prev", function () {
                        if($(this).hasClass("disabled")) return;
                        self.currentPage--;
                        self.currentPage = self.currentPage<0 ? 0 : self.currentPage;
                        self.refreshView(self.currentPage);
                    });

                    $(this.dom).on("click", ".js_page_next", function () {
                        if($(this).hasClass("disabled")) return;
                        self.currentPage++;
                        self.currentPage = self.currentPage>self.size ? self.size : self.currentPage;
                        self.refreshView(self.currentPage);
                    });

                };

                Page.prototype.int = function () {

                    var intSize = this.size>=this.btns ? this.btns : this.size+1;

                    btnsHtml = [
                        '<a href="javascript:;" class="btn js_page_prev disabled">上一页</a>',
                        '<a href="javascript:;" class="btn js_page_next">下一页</a>'
                    ];
                    for (var i = intSize-1; i >= 0 ; i--) {
                        var str = i === 0 ? '<a href="javascript:;" class="btn js_page active">'+(this.currentPage+1+i)+'</a>' : '<a href="javascript:;" class="btn js_page">'+(this.currentPage+1+i)+'</a>';
                        btnsHtml.splice(1, 0, str);
                    };
                    btnsHtml = btnsHtml.join("");

                    $(this.dom).html(btnsHtml);

                    this.event();

                };

                var page = new Page(this, 356);

                page.int();

            }

            $("#page").page();
        })
    </script>
</body>
</html>
