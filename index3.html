<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
	<style>
	 html,body{
		height:100%;
		width:100%;
		padding:0;
		margin:0;
	}
	#dia{
		position: fixed;
		left: 200px;
		width: 200px;
		height: 200px;
		background-color: #ff5500;
		display: none;
		z-index: 2;
	}
	.pageCover{
		width:100%;
		height:100%;
		position:absolute;
		z-index:1;
		background-color:#666;
		opacity:0.5;
		display:none;
	}
	</style>
</head>
<body>
	<div id="pageCover" class="pageCover"></div>
	<div id="dia">
		<a href="javascript:;">X</a>
	</div>
	<a href="javascript:;" id="test">测试</a>
</body>
<script type="text/javascript">
	// Eventtarget class
	function EventTarget(){
		// event store
		this.handlers = {}
	}
	// extrend prototype
	EventTarget.prototype = {
		// constructor
		constructor : EventTarget,
		// addHandler
		addHandler: function (type, handler){
			if(typeof type === "string" && typeof this.handlers[type] === "undefined"){
				this.handlers[type] = new Array();
			}
			this.handlers[type].push(handler);
		},
		// removeHandler
		removeHandler: function (type, handler){
			if(typeof type === "string" && this.handlers[type] instanceof Array){
				var handlers = this.handlers[type];
				for(var i=0, len=handlers.length; i<len; i++){
					if(handlers[i] == handler){
						handlers.splice(i,1);
						break;
					}
				}
			}
		},
		// trigger
		trigger: function (event){
			if(!event.target){
				event.target = this;
			}
			if(typeof event.type === "string" && this.handlers[event.type] instanceof Array){
				var handlers = this.handlers[event.type];
				for(var i=0, len=handlers.length; i<len; i++){
					handlers[i](event);
				}
			}
		}
	}


</script>
<script type="text/javascript">
	// extend to class

	function extend(subType, superType){
		var prototype = Object(superType.prototype);
		prototype.constructor = subType;
		subType.prototype = prototype;
	}


</script>
<script type="text/javascript">
	function Dialog(id){
		EventTarget.call(this);
		this.id = id;
		var self = this;
		document.getElementById(id).children[0].onclick = function(){
			self.close();
		}
	}
	extend(Dialog, EventTarget);

	Dialog.prototype.show = function(){
		var dlg = document.getElementById(this.id);
		dlg.style.display = "block";
		dlg = null;
		this.trigger({type:"show"});
	}

	Dialog.prototype.close = function (){
		var dlg = document.getElementById(this.id);
		dlg.style.display = "none";
		dlg = null;
		this.trigger({type:"close"});
	}


</script>
<script type="text/javascript">

	open = document.getElementById('test');

	var dlg = new Dialog('dia');

	open.onclick = function(){
		dlg.show();
	}
	dlg.addHandler("show", function(){
		document.getElementById("pageCover").style.display = "block";
	});
	dlg.addHandler("close", function(){
		document.getElementById("pageCover").style.display = "none";
	})
</script>
</html>